const initEnquiryForm=()=>{const i=document.querySelector(".js-enquiry-form");if(!i){return}i.addEventListener("submit",e=>{e.preventDefault();const t=i.closest(".enquiry-form");t.classList.remove("enquiry-form--success");t.classList.remove("enquiry-form--failure");const s=new FormData;const n=["first_name","last_name","email","subject","message","enquiry-form-nonce"];let r=true;n.forEach(e=>{const{value:t}=i.querySelector(`[name='${e}']`);if(r){r=t!==""}s.append(e,t)});if(!r){t.classList.add("enquiry-form--invalid");return}t.classList.remove("enquiry-form--invalid");t.classList.add("enquiry-form--processing");s.append("action","enquiry_process_form_data");fetch(ajaxUrl,{method:"POST",body:s}).then(e=>{e.json().then(e=>{t.classList.remove("enquiry-form--processing");t.classList.add(e.success?"enquiry-form--success":"enquiry-form--failure")})}).catch(e=>{t.classList.remove("enquiry-form--processing");t.classList.add("enquiry-form--failure")})})};const initEnquiryResultsExpanders=()=>{const r="enquiry-results";const e=document.querySelectorAll(".js-row-expander");const t=e=>{const t=e.target.closest(`.${r}__grid-row`);const s=t.querySelector(`.${r}__details`);if(s.classList.contains(`${r}__details--open`)){s.classList.remove(`${r}__details--open`);return}const n=t.getAttribute("data-row-id");s.classList.add(`${r}__details--open`);fetch(`${ajaxUrl}?action=enquiry_get_form_record&id=${n}`,{method:"GET"}).then(e=>{e.json().then(e=>{s.classList.add(`${r}__details--loaded`);s.querySelector(`.${r}__details-content`).innerText=e.data})})};e.forEach(e=>e.addEventListener("click",t))};const initEnquiryResultsPageLinks=()=>{const i="enquiry-results";const o=document.querySelectorAll(".js-page-link");const t=e=>{const t=e.target;const s=t.closest(`.${i}__pagination`);const n=t.getAttribute("data-page-number");const r=`${i}__page-link--active`;o.forEach(e=>{e.classList.remove(r)});t.classList.add(r);s.classList.add(`${i}__pagination--loading`);fetch(`${ajaxUrl}?action=enquiry_get_form_data&page_number=${n}`,{method:"GET"}).then(e=>{e.json().then(e=>{s.classList.remove(`${i}__pagination--loading`);renderEnquiryResultsRows(e)})})};o.forEach(e=>e.addEventListener("click",t))};const renderEnquiryResultsRows=e=>{const t="enquiry-results";const s=document.querySelector(".js-grid-rows");const n=document.querySelector(".js-grid-row").cloneNode(true);n.querySelector(`.${t}__details`).classList.remove(`${t}__details--open`);n.querySelector(`.${t}__details`).classList.remove(`${t}__details--loaded`);const r=document.createElement("div");r.style.display="contents";e.data.forEach(e=>{const t=n.cloneNode(true);t.setAttribute("data-row-id",e.id);t.querySelector(".js-first-name").innerText=e.first_name;t.querySelector(".js-last-name").innerText=e.last_name;t.querySelector(".js-subject").innerText=e.subject;t.querySelector(".js-email").innerText=e.email;r.appendChild(t)});s.innerHTML="";s.appendChild(r);initEnquiryResultsExpanders()};document.addEventListener("DOMContentLoaded",()=>{initEnquiryForm();initEnquiryResultsExpanders();initEnquiryResultsPageLinks()});